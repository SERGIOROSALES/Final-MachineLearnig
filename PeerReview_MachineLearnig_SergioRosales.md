# Machine Learning Peer Review
Sergio Rosales  
September 17, 2017  

# Introduction
From a data set collected using devices such as Jawbone Up, Nike FuelBand, and Fitbit; herein I built a model to predict when the barbell lifts are well done or not. Data set comes already in separated files, "pml-testing.csv"" and "pml-training.csv". The construction of the model follows these steps:
## Step 1: Question
Â¿is it possible to predict when a barbell lift is well or bad done?
## Step 2: Data
### Exploring Data
After loading data set we can extract next characteristics from it:

```r
##training
fileNameTraining <- file.path(getwd(),"/pml-training.csv")
training <- read.csv(fileNameTraining, header = TRUE,na.strings= c("#DIV/0!", "NA"))
##testing
fileNameTesting <- file.path(getwd(),"/pml-testing.csv")
testing <- read.csv(fileNameTesting, header = TRUE, na.strings= c("#DIV/0!", "NA"))
dim(training)
```

```
## [1] 19622   160
```

```r
str(training, list.len=10)
```

```
## 'data.frame':	19622 obs. of  160 variables:
##  $ X                       : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ user_name               : Factor w/ 6 levels "adelmo","carlitos",..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ raw_timestamp_part_1    : int  1323084231 1323084231 1323084231 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 ...
##  $ raw_timestamp_part_2    : int  788290 808298 820366 120339 196328 304277 368296 440390 484323 484434 ...
##  $ cvtd_timestamp          : Factor w/ 20 levels "02/12/2011 13:32",..: 9 9 9 9 9 9 9 9 9 9 ...
##  $ new_window              : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
##  $ num_window              : int  11 11 11 12 12 12 12 12 12 12 ...
##  $ roll_belt               : num  1.41 1.41 1.42 1.48 1.48 1.45 1.42 1.42 1.43 1.45 ...
##  $ pitch_belt              : num  8.07 8.07 8.07 8.05 8.07 8.06 8.09 8.13 8.16 8.17 ...
##  $ yaw_belt                : num  -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 ...
##   [list output truncated]
```
### Target
The "classe" variable (categorical) in the training set classifies the manner in which subjects did the exercise in these five categories:
* Class A: exactly according to the specification 
* Class B: throwing the elbows to the front
* Class C: lifting the dumbbell only halfway
* Class D: lowering the dumbbell only halfway
* Class E: throwing the hips to the front

```r
## class of "classe"
class(training$classe)
```

```
## [1] "factor"
```

```r
## Levels of "classe"
levels(training$classe)
```

```
## [1] "A" "B" "C" "D" "E"
```
## Step 3: Features (Predictors)
Prior to any training it is needed to firstly remove all columns with missing values:

```r
training <- training[ , apply(training, 2, function(x) !any(is.na(x)))]
anyNA(training)
```

```
## [1] FALSE
```
Since anyNA() function returs FALSE, it means we don't have any missing values.

## Step 4: Algorithm
I ran a classification model with Cross validation type k-fold (10 folds) and a pre-processing according principal components method.To select splits during the classification I have used "information gain" method by specifying it in the parms parameter.

```r
library(caret)
```

```
## Loading required package: lattice
```

```
## Loading required package: ggplot2
```

```r
library(rpart)
library(rpart.plot)
# define training control
ctrl <- trainControl(method="repeatedcv", number=10, repeats=3, preProcOptions= list(thresh= 0.95))
set.seed(3333)
# train the model
model <- train(as.factor(classe) ~ .,data= training, preProcess= "pca", method="rpart",parms = list(split = "information"), trControl=ctrl, tuneLength = 10)
# summarize results
print(model$finalModel)
```

```
## n= 19622 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##     1) root 19622 14042 A (0.28 0.19 0.17 0.16 0.18)  
##       2) PC8< 0.4962525 11337  6191 A (0.45 0.21 0.16 0.073 0.1)  
##         4) PC5>=0.762124 4724  1020 A (0.78 0.12 0.081 0.0036 0.016)  
##           8) PC8< -0.6028065 3032   134 A (0.96 0.039 0.0049 0 0)  
##            16) PC9>=-1.145371 2621    39 A (0.99 0.013 0.0019 0 0)  
##              32) PC4< 3.654339 2608    26 A (0.99 0.0081 0.0019 0 0)  
##                64) PC8< -1.213258 2133     1 A (1 0.00047 0 0 0) *
##                65) PC8>=-1.213258 475    25 A (0.95 0.042 0.011 0 0)  
##                 130) PC27>=-0.4636271 318     1 A (1 0.0031 0 0 0) *
##                 131) PC27< -0.4636271 157    24 A (0.85 0.12 0.032 0 0)  
##                   262) PC17< 1.130029 139    10 A (0.93 0.072 0 0 0)  
##                     524) PC23>=-1.092886 128     5 A (0.96 0.039 0 0 0)  
##                      1048) PC24< 0.714491 96     0 A (1 0 0 0 0) *
##                      1049) PC24>=0.714491 32     5 A (0.84 0.16 0 0 0)  
##                        2098) PC14>=0.8126284 23     0 A (1 0 0 0 0) *
##                        2099) PC14< 0.8126284 9     4 B (0.44 0.56 0 0 0) *
##                     525) PC23< -1.092886 11     5 A (0.55 0.45 0 0 0) *
##                   263) PC17>=1.130029 18     9 B (0.22 0.5 0.28 0 0) *
##              33) PC4>=3.654339 13     0 B (0 1 0 0 0) *
##            17) PC9< -1.145371 411    95 A (0.77 0.21 0.024 0 0)  
##              34) PC11< -1.07609 257     3 A (0.99 0.012 0 0 0) *
##              35) PC11>=-1.07609 154    72 B (0.4 0.53 0.065 0 0)  
##                70) PC18>=-0.2915096 142    60 B (0.42 0.58 0 0 0)  
##                 140) PC34>=0.7856648 36     2 A (0.94 0.056 0 0 0) *
##                 141) PC34< 0.7856648 106    26 B (0.25 0.75 0 0 0)  
##                   282) PC32< 0.1743075 34    14 A (0.59 0.41 0 0 0)  
##                     564) PC34>=-0.3729976 24     4 A (0.83 0.17 0 0 0)  
##                      1128) PC24< 0.9477422 17     0 A (1 0 0 0 0) *
##                      1129) PC24>=0.9477422 7     3 B (0.43 0.57 0 0 0) *
##                     565) PC34< -0.3729976 10     0 B (0 1 0 0 0) *
##                   283) PC32>=0.1743075 72     6 B (0.083 0.92 0 0 0)  
##                     566) PC7>=4.342546 7     3 A (0.57 0.43 0 0 0) *
##                     567) PC7< 4.342546 65     2 B (0.031 0.97 0 0 0) *
##                71) PC18< -0.2915096 12     2 C (0.17 0 0.83 0 0) *
##           9) PC8>=-0.6028065 1692   886 A (0.48 0.25 0.22 0.01 0.044)  
##            18) PC12>=0.07320799 878   238 A (0.73 0.18 0.025 0 0.069)  
##              36) PC22< 1.824762 817   177 A (0.78 0.19 0.016 0 0.011)  
##                72) PC35< 0.8105919 711    93 A (0.87 0.11 0.017 0 0)  
##                 144) PC17< 0.04779849 438    15 A (0.97 0.03 0.0046 0 0)  
##                   288) PC13< 0.7894634 421     7 A (0.98 0.017 0 0 0)  
##                     576) PC4< 3.405697 414     3 A (0.99 0.0072 0 0 0) *
##                     577) PC4>=3.405697 7     3 B (0.43 0.57 0 0 0) *
##                   289) PC13>=0.7894634 17     8 A (0.53 0.35 0.12 0 0) *
##                 145) PC17>=0.04779849 273    78 A (0.71 0.25 0.037 0 0)  
##                   290) PC12>=1.216608 110     2 A (0.98 0.018 0 0 0) *
##                   291) PC12< 1.216608 163    76 A (0.53 0.4 0.061 0 0)  
##                     582) PC10>=0.1324889 132    50 A (0.62 0.38 0 0 0)  
##                      1164) PC21>=-0.881619 68    10 A (0.85 0.15 0 0 0)  
##                        2328) PC1>=-2.083246 45     0 A (1 0 0 0 0) *
##                        2329) PC1< -2.083246 23    10 A (0.57 0.43 0 0 0)  
##                          4658) PC14>=-0.2884078 11     0 A (1 0 0 0 0) *
##                          4659) PC14< -0.2884078 12     2 B (0.17 0.83 0 0 0) *
##                      1165) PC21< -0.881619 64    24 B (0.38 0.62 0 0 0)  
##                        2330) PC6< 0.07106575 40    16 A (0.6 0.4 0 0 0)  
##                          4660) PC10< 2.561784 31     7 A (0.77 0.23 0 0 0)  
##                            9320) PC3>=-0.9224047 24     1 A (0.96 0.042 0 0 0) *
##                            9321) PC3< -0.9224047 7     1 B (0.14 0.86 0 0 0) *
##                          4661) PC10>=2.561784 9     0 B (0 1 0 0 0) *
##                        2331) PC6>=0.07106575 24     0 B (0 1 0 0 0) *
##                     583) PC10< 0.1324889 31    15 B (0.16 0.52 0.32 0 0)  
##                      1166) PC21< 0.7831662 19     3 B (0.053 0.84 0.11 0 0) *
##                      1167) PC21>=0.7831662 12     4 C (0.33 0 0.67 0 0) *
##                73) PC35>=0.8105919 106    32 B (0.21 0.7 0.0094 0 0.085)  
##                 146) PC30< -0.9196085 69     3 B (0.029 0.96 0.014 0 0) *
##                 147) PC30>=-0.9196085 37    17 A (0.54 0.22 0 0 0.24)  
##                   294) PC10< 1.991783 28     8 A (0.71 0.29 0 0 0)  
##                     588) PC27>=-0.5014217 20     0 A (1 0 0 0 0) *
##                     589) PC27< -0.5014217 8     0 B (0 1 0 0 0) *
##                   295) PC10>=1.991783 9     0 E (0 0 0 0 1) *
##              37) PC22>=1.824762 61     9 E (0 0 0.15 0 0.85)  
##                74) PC2>=3.89059 9     0 C (0 0 1 0 0) *
##                75) PC2< 3.89059 52     0 E (0 0 0 0 1) *
##            19) PC12< 0.07320799 814   468 C (0.2 0.33 0.43 0.021 0.017)  
##              38) PC10>=0.2544257 359   146 B (0.34 0.59 0.053 0 0.017)  
##                76) PC12>=-0.5858749 223   109 A (0.51 0.48 0.0045 0 0)  
##                 152) PC13< 0.5055056 155    52 A (0.66 0.33 0.0065 0 0)  
##                   304) PC26< 0.03406929 90     8 A (0.91 0.089 0 0 0)  
##                     608) PC6>=-1.412266 78     1 A (0.99 0.013 0 0 0) *
##                     609) PC6< -1.412266 12     5 B (0.42 0.58 0 0 0) *
##                   305) PC26>=0.03406929 65    22 B (0.32 0.66 0.015 0 0)  
##                     610) PC23>=-0.7314941 24     4 A (0.83 0.17 0 0 0)  
##                      1220) PC25< -0.03443517 17     0 A (1 0 0 0 0) *
##                      1221) PC25>=-0.03443517 7     3 B (0.43 0.57 0 0 0) *
##                     611) PC23< -0.7314941 41     2 B (0.024 0.95 0.024 0 0) *
##                 153) PC13>=0.5055056 68    11 B (0.16 0.84 0 0 0)  
##                   306) PC11< -0.4805971 23    11 B (0.48 0.52 0 0 0)  
##                     612) PC37< -0.09532864 13     2 A (0.85 0.15 0 0 0) *
##                     613) PC37>=-0.09532864 10     0 B (0 1 0 0 0) *
##                   307) PC11>=-0.4805971 45     0 B (0 1 0 0 0) *
##                77) PC12< -0.5858749 136    31 B (0.051 0.77 0.13 0 0.044)  
##                 154) PC10>=0.7428168 109    11 B (0.037 0.9 0.0092 0 0.055)  
##                   308) PC25< 0.4473413 98     2 B (0.01 0.98 0.01 0 0) *
##                   309) PC25>=0.4473413 11     5 E (0.27 0.18 0 0 0.55) *
##                 155) PC10< 0.7428168 27    10 C (0.11 0.26 0.63 0 0)  
##                   310) PC9>=-0.01441577 10     3 B (0.3 0.7 0 0 0) *
##                   311) PC9< -0.01441577 17     0 C (0 0 1 0 0) *
##              39) PC10< 0.2544257 455   128 C (0.099 0.13 0.72 0.037 0.018)  
##                78) PC13< -1.314029 52    13 A (0.75 0.038 0.21 0 0)  
##                 156) PC11< 0.5649828 41     2 A (0.95 0.049 0 0 0) *
##                 157) PC11>=0.5649828 11     0 C (0 0 1 0 0) *
##                79) PC13>=-1.314029 403    87 C (0.015 0.14 0.78 0.042 0.02)  
##                 158) PC10>=-2.540396 387    71 C (0.016 0.14 0.82 0.023 0)  
##                   316) PC19< 0.9007107 189    60 C (0.021 0.3 0.68 0 0)  
##                     632) PC6< -0.9828372 19     1 B (0.053 0.95 0 0 0) *
##                     633) PC6>=-0.9828372 170    41 C (0.018 0.22 0.76 0 0)  
##                      1266) PC26< 0.3962934 101    41 C (0.03 0.38 0.59 0 0)  
##                        2532) PC37< 0.5071486 60    22 B (0.033 0.63 0.33 0 0)  
##                          5064) PC35< -0.06366954 38     5 B (0.053 0.87 0.079 0 0) *
##                          5065) PC35>=-0.06366954 22     5 C (0 0.23 0.77 0 0)  
##                           10130) PC8< 0.02400197 7     2 B (0 0.71 0.29 0 0) *
##                           10131) PC8>=0.02400197 15     0 C (0 0 1 0 0) *
##                        2533) PC37>=0.5071486 41     1 C (0.024 0 0.98 0 0) *
##                      1267) PC26>=0.3962934 69     0 C (0 0 1 0 0) *
##                   317) PC19>=0.9007107 198    11 C (0.01 0 0.94 0.045 0)  
##                     634) PC4< 2.717849 189     5 C (0.011 0 0.97 0.016 0) *
##                     635) PC4>=2.717849 9     3 D (0 0 0.33 0.67 0) *
##                 159) PC10< -2.540396 16     8 D (0 0 0 0.5 0.5) *
##         5) PC5< 0.762124 6613  4748 B (0.22 0.28 0.21 0.12 0.17)  
##          10) PC10>=-0.03593205 3771  2440 B (0.34 0.35 0.15 0.081 0.069)  
##            20) PC13< -1.015267 1122   299 A (0.73 0.21 0.0053 0.048 0)  
##              40) PC19< 1.216942 1086   265 A (0.76 0.22 0.0055 0.018 0)  
##                80) PC15< 2.075857 1067   246 A (0.77 0.22 0.0056 0.00094 0)  
##                 160) PC12>=-0.5252679 907   147 A (0.84 0.16 0.0044 0 0)  
##                   320) PC19< 0.3293321 859   106 A (0.88 0.12 0.0047 0 0)  
##                     640) PC5>=-3.102155 828    75 A (0.91 0.086 0.0048 0 0)  
##                      1280) PC6< 1.559784 798    48 A (0.94 0.055 0.005 0 0)  
##                        2560) PC30>=-0.6966442 729    20 A (0.97 0.022 0.0055 0 0)  
##                          5120) PC29< 0.05541208 467     0 A (1 0 0 0 0) *
##                          5121) PC29>=0.05541208 262    20 A (0.92 0.061 0.015 0 0)  
##                           10242) PC21< 1.885251 251    12 A (0.95 0.048 0 0 0)  
##                             20484) PC13< -1.785699 150     0 A (1 0 0 0 0) *
##                             20485) PC13>=-1.785699 101    12 A (0.88 0.12 0 0 0)  
##                               40970) PC1< -0.1228669 59     0 A (1 0 0 0 0) *
##                               40971) PC1>=-0.1228669 42    12 A (0.71 0.29 0 0 0)  
##                                 81942) PC12>=0.05143859 29     2 A (0.93 0.069 0 0 0) *
##                                 81943) PC12< 0.05143859 13     3 B (0.23 0.77 0 0 0) *
##                           10243) PC21>=1.885251 11     7 B (0.27 0.36 0.36 0 0) *
##                        2561) PC30< -0.6966442 69    28 A (0.59 0.41 0 0 0)  
##                          5122) PC5>=-2.025556 46     9 A (0.8 0.2 0 0 0)  
##                           10244) PC13< -1.555224 29     0 A (1 0 0 0 0) *
##                           10245) PC13>=-1.555224 17     8 B (0.47 0.53 0 0 0) *
##                          5123) PC5< -2.025556 23     4 B (0.17 0.83 0 0 0)  
##                           10246) PC1>=0.7068879 7     3 A (0.57 0.43 0 0 0) *
##                           10247) PC1< 0.7068879 16     0 B (0 1 0 0 0) *
##                      1281) PC6>=1.559784 30     3 B (0.1 0.9 0 0 0) *
##                     641) PC5< -3.102155 31     0 B (0 1 0 0 0) *
##                   321) PC19>=0.3293321 48     7 B (0.15 0.85 0 0 0)  
##                     642) PC17< -1.18001 8     1 A (0.88 0.12 0 0 0) *
##                     643) PC17>=-1.18001 40     0 B (0 1 0 0 0) *
##                 161) PC12< -0.5252679 160    64 B (0.38 0.6 0.012 0.0062 0)  
##                   322) PC9< 0.6374218 101    40 A (0.6 0.38 0.02 0 0)  
##                     644) PC37>=-0.1398673 73    14 A (0.81 0.19 0 0 0)  
##                      1288) PC36< 0.2103726 44     0 A (1 0 0 0 0) *
##                      1289) PC36>=0.2103726 29    14 A (0.52 0.48 0 0 0)  
##                        2578) PC34< -0.4374875 16     1 A (0.94 0.062 0 0 0) *
##                        2579) PC34>=-0.4374875 13     0 B (0 1 0 0 0) *
##                     645) PC37< -0.1398673 28     4 B (0.071 0.86 0.071 0 0) *
##                   323) PC9>=0.6374218 59     1 B (0 0.98 0 0.017 0) *
##                81) PC15>=2.075857 19     0 D (0 0 0 1 0) *
##              41) PC19>=1.216942 36     2 D (0.056 0 0 0.94 0) *
##            21) PC13>=-1.015267 2649  1557 B (0.18 0.41 0.22 0.094 0.098)  
##              42) PC18>=-2.051337 2407  1315 B (0.2 0.45 0.24 0.074 0.037)  
##                84) PC3>=2.508996 868   496 C (0.33 0.2 0.43 0.037 0)  
##                 168) PC15< -1.429846 211    33 A (0.84 0.15 0.0095 0 0)  
##                   336) PC20>=-0.6804289 146     1 A (0.99 0 0.0068 0 0) *
##                   337) PC20< -0.6804289 65    32 A (0.51 0.48 0.015 0 0)  
##                     674) PC28< -0.04837563 44    11 A (0.75 0.25 0 0 0)  
##                      1348) PC35>=-0.5732372 33     1 A (0.97 0.03 0 0 0) *
##                      1349) PC35< -0.5732372 11     1 B (0.091 0.91 0 0 0) *
##                     675) PC28>=-0.04837563 21     1 B (0 0.95 0.048 0 0) *
##                 169) PC15>=-1.429846 657   287 C (0.17 0.22 0.56 0.049 0)  
##                   338) PC15< 1.202976 622   254 C (0.18 0.23 0.59 0 0)  
##                     676) PC18>=0.4730735 100    51 A (0.49 0.49 0.02 0 0)  
##                      1352) PC35>=0.1620748 45     5 A (0.89 0.11 0 0 0)  
##                        2704) PC32>=0.3634039 37     0 A (1 0 0 0 0) *
##                        2705) PC32< 0.3634039 8     3 B (0.38 0.62 0 0 0) *
##                      1353) PC35< 0.1620748 55    11 B (0.16 0.8 0.036 0 0)  
##                        2706) PC34< -0.251928 8     2 A (0.75 0 0.25 0 0) *
##                        2707) PC34>=-0.251928 47     3 B (0.064 0.94 0 0 0) *
##                     677) PC18< 0.4730735 522   156 C (0.12 0.18 0.7 0 0)  
##                      1354) PC3>=3.812467 77    39 A (0.49 0.42 0.091 0 0)  
##                        2708) PC18>=0.06585123 40     4 A (0.9 0.1 0 0 0)  
##                          5416) PC3>=3.928144 33     0 A (1 0 0 0 0) *
##                          5417) PC3< 3.928144 7     3 B (0.43 0.57 0 0 0) *
##                        2709) PC18< 0.06585123 37     9 B (0.054 0.76 0.19 0 0)  
##                          5418) PC32< -0.966913 30     2 B (0.033 0.93 0.033 0 0) *
##                          5419) PC32>=-0.966913 7     1 C (0.14 0 0.86 0 0) *
##                      1355) PC3< 3.812467 445    86 C (0.052 0.14 0.81 0 0)  
##                        2710) PC9>=0.9229272 24     9 B (0.38 0.62 0 0 0)  
##                          5420) PC36< 0.04709427 10     1 A (0.9 0.1 0 0 0) *
##                          5421) PC36>=0.04709427 14     0 B (0 1 0 0 0) *
##                        2711) PC9< 0.9229272 421    62 C (0.033 0.11 0.85 0 0)  
##                          5422) PC28< -0.8693416 12     4 A (0.67 0.33 0 0 0) *
##                          5423) PC28>=-0.8693416 409    50 C (0.015 0.11 0.88 0 0)  
##                           10846) PC16>=1.192035 44    22 C (0.045 0.45 0.5 0 0)  
##                             21692) PC18>=0.1051245 29     9 B (0.034 0.69 0.28 0 0)  
##                               43384) PC27>=-0.3438237 20     2 B (0.05 0.9 0.05 0 0) *
##                               43385) PC27< -0.3438237 9     2 C (0 0.22 0.78 0 0) *
##                             21693) PC18< 0.1051245 15     1 C (0.067 0 0.93 0 0) *
##                           10847) PC16< 1.192035 365    28 C (0.011 0.066 0.92 0 0)  
##                             21694) PC23>=1.611754 47    14 C (0.043 0.26 0.7 0 0)  
##                               43388) PC1< 5.045658 8     2 B (0.25 0.75 0 0 0) *
##                               43389) PC1>=5.045658 39     6 C (0 0.15 0.85 0 0)  
##                                 86778) PC31< -0.9984613 7     1 B (0 0.86 0.14 0 0) *
##                                 86779) PC31>=-0.9984613 32     0 C (0 0 1 0 0) *
##                             21695) PC23< 1.611754 318    14 C (0.0063 0.038 0.96 0 0)  
##                               43390) PC28< -0.1088858 52    12 C (0.038 0.19 0.77 0 0)  
##                                 86780) PC2>=0.5730883 15     6 B (0 0.6 0.4 0 0) *
##                                 86781) PC2< 0.5730883 37     3 C (0.054 0.027 0.92 0 0) *
##                               43391) PC28>=-0.1088858 266     2 C (0 0.0075 0.99 0 0) *
##                   339) PC15>=1.202976 35     3 D (0 0.029 0.057 0.91 0) *
##                85) PC3< 2.508996 1539   623 B (0.12 0.6 0.13 0.096 0.057)  
##                 170) PC19< 0.6666262 1128   361 B (0.16 0.68 0.03 0.054 0.072)  
##                   340) PC11< 0.84684 943   229 B (0.19 0.76 0.015 0.017 0.017)  
##                     680) PC25< -1.416193 82    18 A (0.78 0 0 0.049 0.17)  
##                      1360) PC20>=-0.02918379 64     0 A (1 0 0 0 0) *
##                      1361) PC20< -0.02918379 18     4 E (0 0 0 0.22 0.78) *
##                     681) PC25>=-1.416193 861   147 B (0.14 0.83 0.016 0.014 0.0023)  
##                      1362) PC25>=-0.1500674 449   128 B (0.25 0.71 0.018 0.013 0)  
##                        2724) PC33>=-0.2216721 212   101 B (0.43 0.52 0.019 0.028 0)  
##                          5448) PC11< 0.1080113 166    77 A (0.54 0.45 0.018 0 0)  
##                           10896) PC18>=0.1413868 133    47 A (0.65 0.35 0 0 0)  
##                             21792) PC22< -0.4220244 58     6 A (0.9 0.1 0 0 0) *
##                             21793) PC22>=-0.4220244 75    34 B (0.45 0.55 0 0 0)  
##                               43586) PC1>=3.215042 30     6 A (0.8 0.2 0 0 0)  
##                                 87172) PC28< -0.6304502 23     1 A (0.96 0.043 0 0 0) *
##                                 87173) PC28>=-0.6304502 7     2 B (0.29 0.71 0 0 0) *
##                               43587) PC1< 3.215042 45    10 B (0.22 0.78 0 0 0)  
##                                 87174) PC15< 0.3491677 14     5 A (0.64 0.36 0 0 0) *
##                                 87175) PC15>=0.3491677 31     1 B (0.032 0.97 0 0 0) *
##                           10897) PC18< 0.1413868 33     6 B (0.091 0.82 0.091 0 0) *
##                          5449) PC11>=0.1080113 46     9 B (0.043 0.8 0.022 0.13 0)  
##                           10898) PC10>=0.5571457 34     0 B (0 1 0 0 0) *
##                           10899) PC10< 0.5571457 12     6 D (0.17 0.25 0.083 0.5 0) *
##                        2725) PC33< -0.2216721 237    27 B (0.097 0.89 0.017 0 0)  
##                          5450) PC30>=0.4991462 81    23 B (0.27 0.72 0.012 0 0)  
##                           10900) PC34>=0.3521858 16     2 A (0.88 0.062 0.062 0 0) *
##                           10901) PC34< 0.3521858 65     8 B (0.12 0.88 0 0 0)  
##                             21802) PC5>=-1.072133 9     3 A (0.67 0.33 0 0 0) *
##                             21803) PC5< -1.072133 56     2 B (0.036 0.96 0 0 0) *
##                          5451) PC30< 0.4991462 156     4 B (0.0064 0.97 0.019 0 0) *
##                      1363) PC25< -0.1500674 412    19 B (0.012 0.95 0.015 0.015 0.0049)  
##                        2726) PC23>=-1.355057 405    12 B (0.012 0.97 0.015 0 0.0025)  
##                          5452) PC7>=-2.838351 384     6 B (0.013 0.98 0 0 0.0026) *
##                          5453) PC7< -2.838351 21     6 B (0 0.71 0.29 0 0)  
##                           10906) PC33< 0.2935526 13     0 B (0 1 0 0 0) *
##                           10907) PC33>=0.2935526 8     2 C (0 0.25 0.75 0 0) *
##                        2727) PC23< -1.355057 7     1 D (0 0 0 0.86 0.14) *
##                   341) PC11>=0.84684 185   120 E (0.011 0.29 0.11 0.24 0.35)  
##                     682) PC21>=0.6541674 80    27 B (0.025 0.66 0.21 0 0.1)  
##                      1364) PC27>=-0.763103 65    12 B (0.031 0.82 0.15 0 0)  
##                        2728) PC18>=0.3448454 47     1 B (0 0.98 0.021 0 0) *
##                        2729) PC18< 0.3448454 18     9 C (0.11 0.39 0.5 0 0) *
##                      1365) PC27< -0.763103 15     7 E (0 0 0.47 0 0.53) *
##                     683) PC21< 0.6541674 105    48 E (0 0 0.029 0.43 0.54)  
##                      1366) PC1>=5.6549 44     1 D (0 0 0 0.98 0.023) *
##                      1367) PC1< 5.6549 61     5 E (0 0 0.049 0.033 0.92) *
##                 171) PC19>=0.6666262 411   245 C (0.0073 0.36 0.4 0.21 0.017)  
##                   342) PC4< -0.389032 290   124 C (0 0.4 0.57 0.031 0)  
##                     684) PC27>=0.3763927 88     2 B (0 0.98 0.011 0.011 0) *
##                     685) PC27< 0.3763927 202    37 C (0 0.14 0.82 0.04 0)  
##                      1370) PC2< -3.554867 14     3 B (0 0.79 0 0.21 0) *
##                      1371) PC2>=-3.554867 188    23 C (0 0.096 0.88 0.027 0)  
##                        2742) PC37>=0.9791608 18     4 B (0 0.78 0.22 0 0) *
##                        2743) PC37< 0.9791608 170     9 C (0 0.024 0.95 0.029 0)  
##                          5486) PC10>=0.993503 7     3 B (0 0.57 0.43 0 0) *
##                          5487) PC10< 0.993503 163     5 C (0 0 0.97 0.031 0) *
##                   343) PC4>=-0.389032 121    44 D (0.025 0.28 0 0.64 0.058)  
##                     686) PC3>=-2.275744 40     6 B (0.075 0.85 0 0 0.075)  
##                      1372) PC3< -0.6034426 33     0 B (0 1 0 0 0) *
##                      1373) PC3>=-0.6034426 7     4 A (0.43 0.14 0 0 0.43) *
##                     687) PC3< -2.275744 81     4 D (0 0 0 0.95 0.049)  
##                      1374) PC1< 3.730192 74     0 D (0 0 0 1 0) *
##                      1375) PC1>=3.730192 7     3 E (0 0 0 0.43 0.57) *
##              43) PC18< -2.051337 242    71 E (0 0 0 0.29 0.71)  
##                86) PC27< -1.153968 60     2 D (0 0 0 0.97 0.033) *
##                87) PC27>=-1.153968 182    13 E (0 0 0 0.071 0.93)  
##                 174) PC33>=0.2175412 19     7 D (0 0 0 0.63 0.37) *
##                 175) PC33< 0.2175412 163     1 E (0 0 0 0.0061 0.99) *
##          11) PC10< -0.03593205 2842  2002 E (0.05 0.19 0.29 0.18 0.3)  
##            22) PC19>=0.03941368 1605   879 C (0.019 0.28 0.45 0.13 0.12)  
##              44) PC23>=-0.6718608 1288   641 C (0.023 0.35 0.5 0.092 0.036)  
##                88) PC19< 1.156451 595   245 B (0.015 0.59 0.31 0.012 0.074)  
##                 176) PC2< -0.9192272 546   196 B (0.016 0.64 0.34 0.0073 0)  
##                   352) PC23>=1.051346 219    20 B (0.0046 0.91 0.087 0 0)  
##                     704) PC18>=-0.3840957 188     4 B (0.0053 0.98 0.016 0 0) *
##                     705) PC18< -0.3840957 31    15 C (0 0.48 0.52 0 0)  
##                      1410) PC3< 3.420359 15     0 B (0 1 0 0 0) *
##                      1411) PC3>=3.420359 16     0 C (0 0 1 0 0) *
##                   353) PC23< 1.051346 327   163 C (0.024 0.46 0.5 0.012 0)  
##                     706) PC27>=0.07155725 73     6 B (0.041 0.92 0.041 0 0) *
##                     707) PC27< 0.07155725 254    93 C (0.02 0.33 0.63 0.016 0)  
##                      1414) PC6< -0.4354916 64    11 B (0 0.83 0.16 0.016 0)  
##                        2828) PC8< -1.136699 53     0 B (0 1 0 0 0) *
##                        2829) PC8>=-1.136699 11     1 C (0 0 0.91 0.091 0) *
##                      1415) PC6>=-0.4354916 190    39 C (0.026 0.16 0.79 0.016 0)  
##                        2830) PC27>=-0.4393516 107    35 C (0.037 0.29 0.67 0 0)  
##                          5660) PC10>=-1.799556 56    27 B (0.071 0.52 0.41 0 0)  
##                           11320) PC24< 0.2106451 37     9 B (0 0.76 0.24 0 0)  
##                             22640) PC9>=-2.993677 29     1 B (0 0.97 0.034 0 0) *
##                             22641) PC9< -2.993677 8     0 C (0 0 1 0 0) *
##                           11321) PC24>=0.2106451 19     5 C (0.21 0.053 0.74 0 0) *
##                          5661) PC10< -1.799556 51     2 C (0 0.039 0.96 0 0) *
##                        2831) PC27< -0.4393516 83     4 C (0.012 0 0.95 0.036 0) *
##                 177) PC2>=-0.9192272 49     5 E (0 0 0.041 0.061 0.9)  
##                   354) PC7>=-0.624049 7     4 D (0 0 0.29 0.43 0.29) *
##                   355) PC7< -0.624049 42     0 E (0 0 0 0 1) *
##                89) PC19>=1.156451 693   231 C (0.03 0.14 0.67 0.16 0.0029)  
##                 178) PC6>=1.284774 118    35 B (0 0.7 0.3 0 0)  
##                   356) PC7>=-0.01021907 65     1 B (0 0.98 0.015 0 0) *
##                   357) PC7< -0.01021907 53    19 C (0 0.36 0.64 0 0)  
##                     714) PC1< 0.3951299 18     0 B (0 1 0 0 0) *
##                     715) PC1>=0.3951299 35     1 C (0 0.029 0.97 0 0) *
##                 179) PC6< 1.284774 575   148 C (0.037 0.023 0.74 0.19 0.0035)  
##                   358) PC21< -0.2542819 109    45 C (0.19 0.12 0.59 0.1 0)  
##                     716) PC1< -2.796184 21    10 D (0.48 0 0 0.52 0)  
##                      1432) PC1< -3.83186 10     0 A (1 0 0 0 0) *
##                      1433) PC1>=-3.83186 11     0 D (0 0 0 1 0) *
##                     717) PC1>=-2.796184 88    24 C (0.12 0.15 0.73 0 0)  
##                      1434) PC6< -0.171678 43    24 C (0.26 0.3 0.44 0 0)  
##                        2868) PC9< -1.203511 13     1 B (0 0.92 0.077 0 0) *
##                        2869) PC9>=-1.203511 30    12 C (0.37 0.033 0.6 0 0)  
##                          5738) PC17< 1.001958 13     2 A (0.85 0 0.15 0 0) *
##                          5739) PC17>=1.001958 17     1 C (0 0.059 0.94 0 0) *
##                      1435) PC6>=-0.171678 45     0 C (0 0 1 0 0) *
##                   359) PC21>=-0.2542819 466   103 C (0 0 0.78 0.22 0.0043)  
##                     718) PC11< 0.001934241 430    74 C (0 0 0.83 0.17 0)  
##                      1436) PC8< -0.3447873 118     0 C (0 0 1 0 0) *
##                      1437) PC8>=-0.3447873 312    74 C (0 0 0.76 0.24 0)  
##                        2874) PC5>=-2.69575 301    63 C (0 0 0.79 0.21 0)  
##                          5748) PC12>=-0.9133135 240    31 C (0 0 0.87 0.13 0)  
##                           11496) PC33< 0.6382828 230    21 C (0 0 0.91 0.091 0)  
##                             22992) PC31>=-0.8491964 206    11 C (0 0 0.95 0.053 0) *
##                             22993) PC31< -0.8491964 24    10 C (0 0 0.58 0.42 0)  
##                               45986) PC2< 5.244599 17     3 C (0 0 0.82 0.18 0) *
##                               45987) PC2>=5.244599 7     0 D (0 0 0 1 0) *
##                           11497) PC33>=0.6382828 10     0 D (0 0 0 1 0) *
##                          5749) PC12< -0.9133135 61    29 D (0 0 0.48 0.52 0)  
##                           11498) PC9>=0.8119807 22     1 C (0 0 0.95 0.045 0) *
##                           11499) PC9< 0.8119807 39     8 D (0 0 0.21 0.79 0)  
##                             22998) PC34>=0.3871673 13     5 C (0 0 0.62 0.38 0) *
##                             22999) PC34< 0.3871673 26     0 D (0 0 0 1 0) *
##                        2875) PC5< -2.69575 11     0 D (0 0 0 1 0) *
##                     719) PC11>=0.001934241 36     9 D (0 0 0.19 0.75 0.056)  
##                      1438) PC16>=0.5209751 13     6 C (0 0 0.54 0.46 0) *
##                      1439) PC16< 0.5209751 23     2 D (0 0 0 0.91 0.087) *
##              45) PC23< -0.6718608 317   173 E (0.0032 0.0032 0.25 0.29 0.45)  
##                90) PC12< -0.740593 175   101 C (0 0 0.42 0.41 0.17)  
##                 180) PC24< 1.50005 125    51 C (0 0 0.59 0.18 0.23)  
##                   360) PC11< 0.7935327 99    25 C (0 0 0.75 0.17 0.081)  
##                     720) PC25< 0.4375089 91    17 C (0 0 0.81 0.19 0)  
##                      1440) PC1< 2.935984 82     8 C (0 0 0.9 0.098 0)  
##                        2880) PC35< 0.1444522 56     0 C (0 0 1 0 0) *
##                        2881) PC35>=0.1444522 26     8 C (0 0 0.69 0.31 0)  
##                          5762) PC3< -0.9916679 18     0 C (0 0 1 0 0) *
##                          5763) PC3>=-0.9916679 8     0 D (0 0 0 1 0) *
##                      1441) PC1>=2.935984 9     0 D (0 0 0 1 0) *
##                     721) PC25>=0.4375089 8     0 E (0 0 0 0 1) *
##                   361) PC11>=0.7935327 26     5 E (0 0 0 0.19 0.81)  
##                     722) PC36>=-0.2188298 9     4 D (0 0 0 0.56 0.44) *
##                     723) PC36< -0.2188298 17     0 E (0 0 0 0 1) *
##                 181) PC24>=1.50005 50     0 D (0 0 0 1 0) *
##                91) PC12>=-0.740593 142    27 E (0.007 0.007 0.035 0.14 0.81)  
##                 182) PC28< 0.4178745 67    20 E (0 0 0 0.3 0.7)  
##                   364) PC10>=-1.907711 38    18 D (0 0 0 0.53 0.47)  
##                     728) PC34< 1.175182 21     1 D (0 0 0 0.95 0.048) *
##                     729) PC34>=1.175182 17     0 E (0 0 0 0 1) *
##                   365) PC10< -1.907711 29     0 E (0 0 0 0 1) *
##                 183) PC28>=0.4178745 75     7 E (0.013 0.013 0.067 0 0.91) *
##            23) PC19< 0.03941368 1237   587 E (0.091 0.07 0.079 0.23 0.53)  
##              46) PC10>=-0.7693675 531   270 D (0.15 0.11 0.1 0.49 0.15)  
##                92) PC1< 0.2496498 230   154 A (0.33 0.096 0.23 0.19 0.16)  
##                 184) PC21>=0.5306569 131    74 A (0.44 0.17 0.4 0 0)  
##                   368) PC24< 0.2437865 74    26 A (0.65 0.26 0.095 0 0)  
##                     736) PC6< 1.008136 60    12 A (0.8 0.083 0.12 0 0)  
##                      1472) PC9>=-2.019764 52     5 A (0.9 0.058 0.038 0 0)  
##                        2944) PC6< 0.1625492 30     0 A (1 0 0 0 0) *
##                        2945) PC6>=0.1625492 22     5 A (0.77 0.14 0.091 0 0)  
##                          5890) PC34>=-0.1175905 15     0 A (1 0 0 0 0) *
##                          5891) PC34< -0.1175905 7     4 B (0.29 0.43 0.29 0 0) *
##                      1473) PC9< -2.019764 8     3 C (0.12 0.25 0.62 0 0) *
##                     737) PC6>=1.008136 14     0 B (0 1 0 0 0) *
##                   369) PC24>=0.2437865 57    12 C (0.16 0.053 0.79 0 0)  
##                     738) PC25>=1.023316 8     0 A (1 0 0 0 0) *
##                     739) PC25< 1.023316 49     4 C (0.02 0.061 0.92 0 0) *
##                 185) PC21< 0.5306569 99    56 D (0.19 0 0.01 0.43 0.36)  
##                   370) PC5>=-0.5655605 19     0 A (1 0 0 0 0) *
##                   371) PC5< -0.5655605 80    37 D (0 0 0.012 0.54 0.45)  
##                     742) PC25>=-1.333119 55    12 D (0 0 0.018 0.78 0.2)  
##                      1484) PC4>=1.917667 40     1 D (0 0 0.025 0.98 0) *
##                      1485) PC4< 1.917667 15     4 E (0 0 0 0.27 0.73) *
##                     743) PC25< -1.333119 25     0 E (0 0 0 0 1) *
##                93) PC1>=0.2496498 301    83 D (0.01 0.11 0.0066 0.72 0.15)  
##                 186) PC21< -0.7333693 30     3 B (0.1 0.9 0 0 0) *
##                 187) PC21>=-0.7333693 271    53 D (0 0.026 0.0074 0.8 0.16)  
##                   374) PC6< 1.550874 239    21 D (0 0 0.0084 0.91 0.079)  
##                     748) PC3>=-1.776208 227     9 D (0 0 0.0088 0.96 0.031)  
##                      1496) PC36< 0.949503 220     4 D (0 0 0.0091 0.98 0.0091) *
##                      1497) PC36>=0.949503 7     2 E (0 0 0 0.29 0.71) *
##                     749) PC3< -1.776208 12     0 E (0 0 0 0 1) *
##                   375) PC6>=1.550874 32     7 E (0 0.22 0 0 0.78)  
##                     750) PC11< 0.7581397 7     0 B (0 1 0 0 0) *
##                     751) PC11>=0.7581397 25     0 E (0 0 0 0 1) *
##              47) PC10< -0.7693675 706   136 E (0.047 0.044 0.061 0.041 0.81)  
##                94) PC2< 0.2462959 312   136 E (0.11 0.099 0.14 0.093 0.56)  
##                 188) PC21>=0.3615758 87    44 C (0.38 0.13 0.49 0 0)  
##                   376) PC13< -1.072059 41    10 A (0.76 0.24 0 0 0)  
##                     752) PC11< -0.6736163 30     0 A (1 0 0 0 0) *
##                     753) PC11>=-0.6736163 11     1 B (0.091 0.91 0 0 0) *
##                   377) PC13>=-1.072059 46     3 C (0.043 0.022 0.93 0 0) *
##                 189) PC21< 0.3615758 225    49 E (0 0.089 0 0.13 0.78)  
##                   378) PC23>=1.692895 20     0 B (0 1 0 0 0) *
##                   379) PC23< 1.692895 205    29 E (0 0 0 0.14 0.86)  
##                     758) PC6< 0.6761301 55    26 D (0 0 0 0.53 0.47)  
##                      1516) PC14< -0.9060421 21     0 D (0 0 0 1 0) *
##                      1517) PC14>=-0.9060421 34     8 E (0 0 0 0.24 0.76)  
##                        3034) PC34< 0.268013 11     3 D (0 0 0 0.73 0.27) *
##                        3035) PC34>=0.268013 23     0 E (0 0 0 0 1) *
##                     759) PC6>=0.6761301 150     0 E (0 0 0 0 1) *
##                95) PC2>=0.2462959 394     0 E (0 0 0 0 1) *
##       3) PC8>=0.4962525 8285  5852 E (0.052 0.17 0.2 0.29 0.29)  
##         6) PC13< 1.062051 6541  4546 D (0.066 0.2 0.25 0.3 0.18)  
##          12) PC18>=0.1464813 2351  1411 B (0.14 0.4 0.22 0.15 0.086)  
##            24) PC22>=-0.705164 2029  1103 B (0.16 0.46 0.26 0.098 0.022)  
##              48) PC10>=1.414939 639   147 B (0.17 0.77 0.011 0.044 0.0047)  
##                96) PC28< 1.826499 609   119 B (0.18 0.8 0.011 0 0.0049)  
##                 192) PC27< 0.05955277 196    99 B (0.47 0.49 0.015 0 0.015)  
##                   384) PC24>=0.3409686 136    49 A (0.64 0.34 0.022 0 0)  
##                     768) PC13< -0.4272939 64     6 A (0.91 0.094 0 0 0) *
##                     769) PC13>=-0.4272939 72    32 B (0.4 0.56 0.042 0 0)  
##                      1538) PC15< 0.8401974 46    18 A (0.61 0.33 0.065 0 0)  
##                        3076) PC17< 0.09839824 35     7 A (0.8 0.11 0.086 0 0)  
##                          6152) PC11< -0.02877593 25     0 A (1 0 0 0 0) *
##                          6153) PC11>=-0.02877593 10     6 B (0.3 0.4 0.3 0 0) *
##                        3077) PC17>=0.09839824 11     0 B (0 1 0 0 0) *
##                      1539) PC15>=0.8401974 26     1 B (0.038 0.96 0 0 0) *
##                   385) PC24< 0.3409686 60     9 B (0.1 0.85 0 0 0.05)  
##                     770) PC31>=-0.09515665 51     1 B (0.02 0.98 0 0 0) *
##                     771) PC31< -0.09515665 9     4 A (0.56 0.11 0 0 0.33) *
##                 193) PC27>=0.05955277 413    20 B (0.039 0.95 0.0097 0 0)  
##                   386) PC13< -1.405094 16     3 A (0.81 0.19 0 0 0) *
##                   387) PC13>=-1.405094 397     7 B (0.0076 0.98 0.01 0 0) *
##                97) PC28>=1.826499 30     2 D (0 0.067 0 0.93 0) *
##              49) PC10< 1.414939 1390   870 C (0.16 0.31 0.37 0.12 0.03)  
##                98) PC3>=-1.354458 960   611 B (0.23 0.36 0.34 0.022 0.044)  
##                 196) PC15< -0.05386192 649   334 C (0.25 0.26 0.49 0.011 0)  
##                   392) PC28< -0.06513786 350   201 A (0.43 0.3 0.25 0.02 0)  
##                     784) PC30>=0.4383059 120    25 A (0.79 0.16 0.05 0 0)  
##                      1568) PC23< 1.375155 107    12 A (0.89 0.056 0.056 0 0)  
##                        3136) PC6< 1.073537 100     7 A (0.93 0.01 0.06 0 0) *
##                        3137) PC6>=1.073537 7     2 B (0.29 0.71 0 0 0) *
##                      1569) PC23>=1.375155 13     0 B (0 1 0 0 0) *
##                     785) PC30< 0.4383059 230   143 B (0.23 0.38 0.36 0.03 0)  
##                      1570) PC11< -0.4899848 85    40 A (0.53 0.42 0.047 0 0)  
##                        3140) PC12>=0.2855831 29     1 A (0.97 0.034 0 0 0) *
##                        3141) PC12< 0.2855831 56    21 B (0.3 0.62 0.071 0 0)  
##                          6282) PC6>=-0.3368341 21     7 A (0.67 0.19 0.14 0 0)  
##                           12564) PC4< -1.313133 12     0 A (1 0 0 0 0) *
##                           12565) PC4>=-1.313133 9     5 B (0.22 0.44 0.33 0 0) *
##                          6283) PC6< -0.3368341 35     4 B (0.086 0.89 0.029 0 0) *
##                      1571) PC11>=-0.4899848 145    67 C (0.062 0.35 0.54 0.048 0)  
##                        3142) PC4>=1.521296 19    12 D (0.32 0.32 0 0.37 0) *
##                        3143) PC4< 1.521296 126    48 C (0.024 0.36 0.62 0 0)  
##                          6286) PC2< -3.647361 19     0 B (0 1 0 0 0) *
##                          6287) PC2>=-3.647361 107    29 C (0.028 0.24 0.73 0 0)  
##                           12574) PC6< -1.27051 17     1 B (0 0.94 0.059 0 0) *
##                           12575) PC6>=-1.27051 90    13 C (0.033 0.11 0.86 0 0)  
##                             25150) PC28< -0.9273421 16     6 B (0.12 0.62 0.25 0 0) *
##                             25151) PC28>=-0.9273421 74     1 C (0.014 0 0.99 0 0) *
##                   393) PC28>=-0.06513786 299    72 C (0.04 0.2 0.76 0 0)  
##                     786) PC2< -0.1577098 156    64 C (0.032 0.38 0.59 0 0)  
##                      1572) PC18>=0.5220636 44    10 B (0.045 0.77 0.18 0 0)  
##                        3144) PC23< 1.799284 36     2 B (0.056 0.94 0 0 0) *
##                        3145) PC23>=1.799284 8     0 C (0 0 1 0 0) *
##                      1573) PC18< 0.5220636 112    28 C (0.027 0.22 0.75 0 0)  
##                        3146) PC13>=0.0254612 30    12 B (0 0.6 0.4 0 0)  
##                          6292) PC31< -0.1524745 23     5 B (0 0.78 0.22 0 0) *
##                          6293) PC31>=-0.1524745 7     0 C (0 0 1 0 0) *
##                        3147) PC13< 0.0254612 82    10 C (0.037 0.085 0.88 0 0)  
##                          6294) PC6>=1.28524 7     4 A (0.43 0.29 0.29 0 0) *
##                          6295) PC6< 1.28524 75     5 C (0 0.067 0.93 0 0)  
##                           12590) PC8< 0.8115133 7     2 B (0 0.71 0.29 0 0) *
##                           12591) PC8>=0.8115133 68     0 C (0 0 1 0 0) *
##                     787) PC2>=-0.1577098 143     8 C (0.049 0.007 0.94 0 0)  
##                      1574) PC18>=0.7465115 7     1 A (0.86 0 0.14 0 0) *
##                      1575) PC18< 0.7465115 136     2 C (0.0074 0.0074 0.99 0 0) *
##                 197) PC15>=-0.05386192 311   128 B (0.2 0.59 0.032 0.045 0.14)  
##                   394) PC21>=0.6847836 178    12 B (0.062 0.93 0.0056 0 0)  
##                     788) PC35>=1.554078 9     2 A (0.78 0.22 0 0 0) *
##                     789) PC35< 1.554078 169     5 B (0.024 0.97 0.0059 0 0) *
##                   395) PC21< 0.6847836 133    82 A (0.38 0.13 0.068 0.11 0.32)  
##                     790) PC12>=-0.1339175 60    13 A (0.78 0.2 0 0 0.017)  
##                      1580) PC19< -0.1203973 45     1 A (0.98 0 0 0 0.022) *
##                      1581) PC19>=-0.1203973 15     3 B (0.2 0.8 0 0 0) *
##                     791) PC12< -0.1339175 73    32 E (0.055 0.068 0.12 0.19 0.56)  
##                      1582) PC31>=-0.8957345 56    18 E (0.071 0.089 0.16 0 0.68)  
##                        3164) PC7>=-0.7109186 20    11 C (0.15 0.25 0.45 0 0.15)  
##                          6328) PC15< 1.55641 12     3 C (0.25 0 0.75 0 0) *
##                          6329) PC15>=1.55641 8     3 B (0 0.62 0 0 0.38) *
##                        3165) PC7< -0.7109186 36     1 E (0.028 0 0 0 0.97) *
##                      1583) PC31< -0.8957345 17     3 D (0 0 0 0.82 0.18) *
##                99) PC3< -1.354458 430   235 C (0 0.2 0.45 0.35 0)  
##                 198) PC4>=-3.457125 334   139 C (0 0.25 0.58 0.16 0)  
##                   396) PC1>=-2.404679 146    61 B (0 0.58 0.32 0.096 0)  
##                     792) PC10>=0.6819179 59     3 B (0 0.95 0 0.051 0) *
##                     793) PC10< 0.6819179 87    40 C (0 0.33 0.54 0.13 0)  
##                      1586) PC12>=0.1955666 36     8 B (0 0.78 0.22 0 0)  
##                        3172) PC22>=0.02800696 29     1 B (0 0.97 0.034 0 0) *
##                        3173) PC22< 0.02800696 7     0 C (0 0 1 0 0) *
##                      1587) PC12< 0.1955666 51    12 C (0 0.02 0.76 0.22 0)  
##                        3174) PC23>=-0.3047372 39     0 C (0 0 1 0 0) *
##                        3175) PC23< -0.3047372 12     1 D (0 0.083 0 0.92 0) *
##                   397) PC1< -2.404679 188    40 C (0 0 0.79 0.21 0)  
##                     794) PC28< 0.9305652 163    16 C (0 0 0.9 0.098 0)  
##                      1588) PC2< -1.856927 148     1 C (0 0 0.99 0.0068 0) *
##                      1589) PC2>=-1.856927 15     0 D (0 0 0 1 0) *
##                     795) PC28>=0.9305652 25     1 D (0 0 0.04 0.96 0) *
##                 199) PC4< -3.457125 96     0 D (0 0 0 1 0) *
##            25) PC22< -0.705164 322   165 E (0 0.043 0 0.47 0.49)  
##              50) PC27>=-0.4995226 219    69 D (0 0.064 0 0.68 0.25)  
##               100) PC10>=-0.751007 171    25 D (0 0.082 0 0.85 0.064)  
##                 200) PC10>=1.744423 14     0 B (0 1 0 0 0) *
##                 201) PC10< 1.744423 157    11 D (0 0 0 0.93 0.07)  
##                   402) PC1< 3.951591 150     5 D (0 0 0 0.97 0.033)  
##                     804) PC6< 0.8392636 143     0 D (0 0 0 1 0) *
##                     805) PC6>=0.8392636 7     2 E (0 0 0 0.29 0.71) *
##                   403) PC1>=3.951591 7     1 E (0 0 0 0.14 0.86) *
##               101) PC10< -0.751007 48     4 E (0 0 0 0.083 0.92)  
##                 202) PC2>=5.448809 7     3 D (0 0 0 0.57 0.43) *
##                 203) PC2< 5.448809 41     0 E (0 0 0 0 1) *
##              51) PC27< -0.4995226 103     1 E (0 0 0 0.0097 0.99) *
##          13) PC18< 0.1464813 4190  2545 D (0.023 0.084 0.26 0.39 0.24)  
##            26) PC2>=3.25081 646   382 B (0.09 0.41 0.37 0.13 0)  
##              52) PC13< -0.8580416 195    59 B (0.3 0.7 0.0051 0 0)  
##               104) PC25>=0.3582527 75    17 A (0.77 0.23 0 0 0)  
##                 208) PC11< 0.1306731 59     1 A (0.98 0.017 0 0 0) *
##                 209) PC11>=0.1306731 16     0 B (0 1 0 0 0) *
##               105) PC25< 0.3582527 120     1 B (0 0.99 0.0083 0 0) *
##              53) PC13>=-0.8580416 451   215 C (0 0.28 0.52 0.19 0)  
##               106) PC10>=0.3225733 135    49 B (0 0.64 0.36 0 0)  
##                 212) PC18>=-0.400038 85     7 B (0 0.92 0.082 0 0)  
##                   424) PC28< 0.04519618 76     0 B (0 1 0 0 0) *
##                   425) PC28>=0.04519618 9     2 C (0 0.22 0.78 0 0) *
##                 213) PC18< -0.400038 50     8 C (0 0.16 0.84 0 0)  
##                   426) PC11< -0.0629945 7     0 B (0 1 0 0 0) *
##                   427) PC11>=-0.0629945 43     1 C (0 0.023 0.98 0 0) *
##               107) PC10< 0.3225733 316   129 C (0 0.13 0.59 0.28 0)  
##                 214) PC32>=0.2406263 32     2 B (0 0.94 0.062 0 0) *
##                 215) PC32< 0.2406263 284    99 C (0 0.042 0.65 0.31 0)  
##                   430) PC13< -0.528322 100    12 C (0 0.07 0.88 0.05 0)  
##                     860) PC26>=0.444371 10     3 B (0 0.7 0.3 0 0) *
##                     861) PC26< 0.444371 90     5 C (0 0 0.94 0.056 0)  
##                      1722) PC19< 1.810384 83     1 C (0 0 0.99 0.012 0) *
##                      1723) PC19>=1.810384 7     3 D (0 0 0.43 0.57 0) *
##                   431) PC13>=-0.528322 184    87 C (0 0.027 0.53 0.45 0)  
##                     862) PC6< -0.09177005 35     0 C (0 0 1 0 0) *
##                     863) PC6>=-0.09177005 149    67 D (0 0.034 0.42 0.55 0)  
##                      1726) PC15< 0.807982 21     6 C (0 0.24 0.71 0.048 0)  
##                        3452) PC23< 0.970257 7     2 B (0 0.71 0.14 0.14 0) *
##                        3453) PC23>=0.970257 14     0 C (0 0 1 0 0) *
##                      1727) PC15>=0.807982 128    47 D (0 0 0.37 0.63 0)  
##                        3454) PC30>=0.5472387 69    29 C (0 0 0.58 0.42 0)  
##                          6908) PC12>=-0.4775848 49    11 C (0 0 0.78 0.22 0)  
##                           13816) PC17< 1.034333 32     0 C (0 0 1 0 0) *
##                           13817) PC17>=1.034333 17     6 D (0 0 0.35 0.65 0) *
##                          6909) PC12< -0.4775848 20     2 D (0 0 0.1 0.9 0) *
##                        3455) PC30< 0.5472387 59     7 D (0 0 0.12 0.88 0)  
##                          6910) PC34>=0.3494864 8     2 C (0 0 0.75 0.25 0) *
##                          6911) PC34< 0.3494864 51     1 D (0 0 0.02 0.98 0) *
##            27) PC2< 3.25081 3544  1986 D (0.011 0.025 0.24 0.44 0.28)  
##              54) PC27< -0.5547016 878   292 C (0 0.0091 0.67 0.12 0.2)  
##               108) PC24>=-0.5815067 763   177 C (0 0.01 0.77 0.14 0.084)  
##                 216) PC11< 1.189916 683   102 C (0 0.012 0.85 0.11 0.025)  
##                   432) PC37>=0.04603056 528    40 C (0 0 0.92 0.045 0.03)  
##                     864) PC10< -0.6645075 509    28 C (0 0 0.94 0.024 0.031)  
##                      1728) PC34< 0.3788106 449    13 C (0 0 0.97 0.024 0.0045)  
##                        3456) PC3>=-1.424252 405     4 C (0 0 0.99 0.0074 0.0025) *
##                        3457) PC3< -1.424252 44     9 C (0 0 0.8 0.18 0.023)  
##                          6914) PC27>=-0.9361618 20     0 C (0 0 1 0 0) *
##                          6915) PC27< -0.9361618 24     9 C (0 0 0.62 0.33 0.042)  
##                           13830) PC2>=1.979405 11     0 C (0 0 1 0 0) *
##                           13831) PC2< 1.979405 13     5 D (0 0 0.31 0.62 0.077) *
##                      1729) PC34>=0.3788106 60    15 C (0 0 0.75 0.017 0.23)  
##                        3458) PC36>=0.08369397 45     1 C (0 0 0.98 0.022 0) *
##                        3459) PC36< 0.08369397 15     1 E (0 0 0.067 0 0.93) *
##                     865) PC10>=-0.6645075 19     7 D (0 0 0.37 0.63 0) *
##                   433) PC37< 0.04603056 155    62 C (0 0.052 0.6 0.34 0.0065)  
##                     866) PC22>=-1.504498 121    29 C (0 0.066 0.76 0.17 0.0083)  
##                      1732) PC2< -3.306741 8     1 B (0 0.88 0 0.12 0) *
##                      1733) PC2>=-3.306741 113    21 C (0 0.0088 0.81 0.17 0.0088)  
##                        3466) PC31>=0.2993057 52     2 C (0 0.019 0.96 0 0.019) *
##                        3467) PC31< 0.2993057 61    19 C (0 0 0.69 0.31 0)  
##                          6934) PC11< 0.4244223 54    12 C (0 0 0.78 0.22 0)  
##                           13868) PC10>=-2.407763 47     6 C (0 0 0.87 0.13 0) *
##                           13869) PC10< -2.407763 7     1 D (0 0 0.14 0.86 0) *
##                          6935) PC11>=0.4244223 7     0 D (0 0 0 1 0) *
##                     867) PC22< -1.504498 34     1 D (0 0 0.029 0.97 0) *
##                 217) PC11>=1.189916 80    33 E (0 0 0.062 0.35 0.59)  
##                   434) PC13< -0.7996237 28     8 D (0 0 0.18 0.71 0.11)  
##                     868) PC3>=0.1911874 8     3 C (0 0 0.62 0 0.38) *
##                     869) PC3< 0.1911874 20     0 D (0 0 0 1 0) *
##                   435) PC13>=-0.7996237 52     8 E (0 0 0 0.15 0.85)  
##                     870) PC2>=-2.112188 7     2 D (0 0 0 0.71 0.29) *
##                     871) PC2< -2.112188 45     3 E (0 0 0 0.067 0.93) *
##               109) PC24< -0.5815067 115     1 E (0 0 0 0.0087 0.99) *
##              55) PC27>=-0.5547016 2666  1214 D (0.015 0.03 0.1 0.54 0.31)  
##               110) PC24>=0.1927216 939   540 E (0.043 0.063 0.27 0.2 0.42)  
##                 220) PC3>=2.086681 419   179 C (0.095 0.13 0.57 0.036 0.16)  
##                   440) PC20< 0.3307835 335    95 C (0.12 0.16 0.72 0 0)  
##                     880) PC28< 0.0725516 152    91 C (0.26 0.34 0.4 0 0)  
##                      1760) PC9>=1.065183 53    13 B (0.15 0.75 0.094 0 0)  
##                        3520) PC37< 0.009389116 14     7 A (0.5 0.14 0.36 0 0) *
##                        3521) PC37>=0.009389116 39     1 B (0.026 0.97 0 0 0) *
##                      1761) PC9< 1.065183 99    43 C (0.32 0.11 0.57 0 0)  
##                        3522) PC15< -1.474895 21     2 A (0.9 0.095 0 0 0) *
##                        3523) PC15>=-1.474895 78    22 C (0.17 0.12 0.72 0 0)  
##                          7046) PC1< -5.008149 14     5 B (0 0.64 0.36 0 0) *
##                          7047) PC1>=-5.008149 64    13 C (0.2 0 0.8 0 0)  
##                           14094) PC11< -1.711322 27    13 C (0.48 0 0.52 0 0)  
##                             28188) PC18>=0.01321745 12     0 A (1 0 0 0 0) *
##                             28189) PC18< 0.01321745 15     1 C (0.067 0 0.93 0 0) *
##                           14095) PC11>=-1.711322 37     0 C (0 0 1 0 0) *
##                     881) PC28>=0.0725516 183     4 C (0 0.022 0.98 0 0) *
##                   441) PC20>=0.3307835 84    15 E (0 0 0 0.18 0.82)  
##                     882) PC9>=-0.6957783 15     2 D (0 0 0 0.87 0.13) *
##                     883) PC9< -0.6957783 69     2 E (0 0 0 0.029 0.97) *
##                 221) PC3< 2.086681 520   190 E (0 0.0077 0.027 0.33 0.63)  
##                   442) PC10>=-1.673108 291   123 D (0 0.014 0.027 0.58 0.38)  
##                     884) PC37>=-0.7472713 215    55 D (0 0.019 0.037 0.74 0.2)  
##                      1768) PC7>=-0.1749651 182    22 D (0 0 0.016 0.88 0.1)  
##                        3536) PC28< 0.3760523 140     4 D (0 0 0.0071 0.97 0.021) *
##                        3537) PC28>=0.3760523 42    18 D (0 0 0.048 0.57 0.38)  
##                          7074) PC36>=0.2523514 19     2 D (0 0 0.11 0.89 0) *
##                          7075) PC36< 0.2523514 23     7 E (0 0 0 0.3 0.7)  
##                           14150) PC12>=-0.8541985 12     5 D (0 0 0 0.58 0.42) *
##                           14151) PC12< -0.8541985 11     0 E (0 0 0 0 1) *
##                      1769) PC7< -0.1749651 33     9 E (0 0.12 0.15 0 0.73)  
##                        3538) PC9>=0.9176058 10     5 C (0 0.4 0.5 0 0.1) *
##                        3539) PC9< 0.9176058 23     0 E (0 0 0 0 1) *
##                     885) PC37< -0.7472713 76     8 E (0 0 0 0.11 0.89)  
##                      1770) PC7< 2.551028 12     4 D (0 0 0 0.67 0.33) *
##                      1771) PC7>=2.551028 64     0 E (0 0 0 0 1) *
##                   443) PC10< -1.673108 229    10 E (0 0 0.026 0.017 0.96)  
##                     886) PC27< -0.4516509 12     6 C (0 0 0.5 0.083 0.42) *
##                     887) PC27>=-0.4516509 217     3 E (0 0 0 0.014 0.99) *
##               111) PC24< 0.1927216 1727   462 D (0 0.013 0.011 0.73 0.24)  
##                 222) PC20< 0.8639852 1516   280 D (0 0.015 0.013 0.82 0.16)  
##                   444) PC25< 0.9092525 1413   193 D (0 0.015 0.011 0.86 0.11)  
##                     888) PC28< 0.1022473 904    28 D (0 0.0044 0.0033 0.97 0.023)  
##                      1776) PC37>=-0.9695196 887    15 D (0 0.0045 0.0034 0.98 0.009)  
##                        3552) PC21>=1.418843 7     3 B (0 0.57 0 0.43 0) *
##                        3553) PC21< 1.418843 880    11 D (0 0 0.0034 0.99 0.0091)  
##                          7106) PC27< -0.4117931 44     3 D (0 0 0.068 0.93 0) *
##                          7107) PC27>=-0.4117931 836     8 D (0 0 0 0.99 0.0096)  
##                           14214) PC6< -0.1775011 501     0 D (0 0 0 1 0) *
##                           14215) PC6>=-0.1775011 335     8 D (0 0 0 0.98 0.024)  
##                             28430) PC2< 1.399249 328     3 D (0 0 0 0.99 0.0091) *
##                             28431) PC2>=1.399249 7     2 E (0 0 0 0.29 0.71) *
##                      1777) PC37< -0.9695196 17     4 E (0 0 0 0.24 0.76) *
##                     889) PC28>=0.1022473 509   165 D (0 0.033 0.024 0.68 0.27)  
##                      1778) PC3>=0.7534993 402    76 D (0 0 0.025 0.81 0.16)  
##                        3556) PC31>=0.1630987 198     7 D (0 0 0.015 0.96 0.02)  
##                          7112) PC28< 1.181201 191     3 D (0 0 0.016 0.98 0) *
##                          7113) PC28>=1.181201 7     3 E (0 0 0 0.43 0.57) *
##                        3557) PC31< 0.1630987 204    69 D (0 0 0.034 0.66 0.3)  
##                          7114) PC18>=-0.2913728 99     6 D (0 0 0.01 0.94 0.051)  
##                           14228) PC13< 0.04864873 92     1 D (0 0 0.011 0.99 0) *
##                           14229) PC13>=0.04864873 7     2 E (0 0 0 0.29 0.71) *
##                          7115) PC18< -0.2913728 105    48 E (0 0 0.057 0.4 0.54)  
##                           14230) PC12>=-0.1828439 50    15 D (0 0 0.12 0.7 0.18)  
##                             28460) PC10< -0.8373496 7     1 C (0 0 0.86 0 0.14) *
##                             28461) PC10>=-0.8373496 43     8 D (0 0 0 0.81 0.19)  
##                               56922) PC27>=0.2726467 36     2 D (0 0 0 0.94 0.056) *
##                               56923) PC27< 0.2726467 7     1 E (0 0 0 0.14 0.86) *
##                           14231) PC12< -0.1828439 55     7 E (0 0 0 0.13 0.87) *
##                      1779) PC3< 0.7534993 107    37 E (0 0.16 0.019 0.17 0.65)  
##                        3558) PC33< -1.114761 18     2 B (0 0.89 0.11 0 0) *
##                        3559) PC33>=-1.114761 89    19 E (0 0.011 0 0.2 0.79)  
##                          7118) PC5>=0.5943744 34    16 D (0 0.029 0 0.53 0.44)  
##                           14236) PC15>=-0.9691433 16     1 D (0 0.063 0 0.94 0) *
##                           14237) PC15< -0.9691433 18     3 E (0 0 0 0.17 0.83) *
##                          7119) PC5< 0.5943744 55     0 E (0 0 0 0 1) *
##                   445) PC25>=0.9092525 103    21 E (0 0.0097 0.039 0.16 0.8)  
##                     890) PC30< 0.4909094 35    19 D (0 0.029 0.11 0.46 0.4)  
##                      1780) PC10>=1.107446 18     2 D (0 0 0 0.89 0.11) *
##                      1781) PC10< 1.107446 17     5 E (0 0.059 0.24 0 0.71) *
##                     891) PC30>=0.4909094 68     0 E (0 0 0 0 1) *
##                 223) PC20>=0.8639852 211    29 E (0 0 0 0.14 0.86)  
##                   446) PC4< -1.02662 37     8 D (0 0 0 0.78 0.22)  
##                     892) PC5< 0.05311656 29     0 D (0 0 0 1 0) *
##                     893) PC5>=0.05311656 8     0 E (0 0 0 0 1) *
##                   447) PC4>=-1.02662 174     0 E (0 0 0 0 1) *
##         7) PC13>=1.062051 1744   511 E (0.0023 0.054 0.008 0.23 0.71)  
##          14) PC11< 0.4941071 1079   476 E (0.0037 0.08 0.011 0.35 0.56)  
##            28) PC10>=2.125525 59    10 B (0 0.83 0.14 0.034 0)  
##              56) PC19< 0.8407771 49     0 B (0 1 0 0 0) *
##              57) PC19>=0.8407771 10     2 C (0 0 0.8 0.2 0) *
##            29) PC10< 2.125525 1020   417 E (0.0039 0.036 0.0039 0.36 0.59)  
##              58) PC3< 1.322687 702   342 D (0 0.011 0.0043 0.51 0.47)  
##               116) PC13< 1.758394 357    87 D (0 0.022 0.0084 0.76 0.21)  
##                 232) PC27< 0.06079071 244    20 D (0 0 0 0.92 0.082)  
##                   464) PC33< 0.8558956 231     8 D (0 0 0 0.97 0.035) *
##                   465) PC33>=0.8558956 13     1 E (0 0 0 0.077 0.92) *
##                 233) PC27>=0.06079071 113    57 E (0 0.071 0.027 0.41 0.5)  
##                   466) PC26< -0.4309102 14     6 B (0 0.57 0.21 0 0.21) *
##                   467) PC26>=-0.4309102 99    46 E (0 0 0 0.46 0.54)  
##                     934) PC32>=-0.1277255 36     4 D (0 0 0 0.89 0.11)  
##                      1868) PC11< 0.3073522 29     0 D (0 0 0 1 0) *
##                      1869) PC11>=0.3073522 7     3 E (0 0 0 0.43 0.57) *
##                     935) PC32< -0.1277255 63    14 E (0 0 0 0.22 0.78)  
##                      1870) PC19< -0.261859 30    14 E (0 0 0 0.47 0.53)  
##                        3740) PC16>=-0.5132252 13     0 D (0 0 0 1 0) *
##                        3741) PC16< -0.5132252 17     1 E (0 0 0 0.059 0.94) *
##                      1871) PC19>=-0.261859 33     0 E (0 0 0 0 1) *
##               117) PC13>=1.758394 345    90 E (0 0 0 0.26 0.74)  
##                 234) PC33< -1.159047 48     2 D (0 0 0 0.96 0.042) *
##                 235) PC33>=-1.159047 297    44 E (0 0 0 0.15 0.85)  
##                   470) PC35>=0.5668731 48    17 D (0 0 0 0.65 0.35)  
##                     940) PC9< 0.8245948 31     0 D (0 0 0 1 0) *
##                     941) PC9>=0.8245948 17     0 E (0 0 0 0 1) *
##                   471) PC35< 0.5668731 249    13 E (0 0 0 0.052 0.95)  
##                     942) PC14< -0.7523924 19     6 D (0 0 0 0.68 0.32) *
##                     943) PC14>=-0.7523924 230     0 E (0 0 0 0 1) *
##              59) PC3>=1.322687 318    46 E (0.013 0.091 0.0031 0.038 0.86)  
##               118) PC21>=0.5415042 32     3 B (0.062 0.91 0.031 0 0) *
##               119) PC21< 0.5415042 286    14 E (0.007 0 0 0.042 0.95)  
##                 238) PC7>=-0.2583322 32    14 E (0.063 0 0 0.37 0.56)  
##                   476) PC6>=-0.01432535 14     2 D (0.14 0 0 0.86 0) *
##                   477) PC6< -0.01432535 18     0 E (0 0 0 0 1) *
##                 239) PC7< -0.2583322 254     0 E (0 0 0 0 1) *
##          15) PC11>=0.4941071 665    35 E (0 0.012 0.003 0.038 0.95)  
##            30) PC17>=1.416631 20     7 D (0 0.35 0 0.65 0)  
##              60) PC6>=-0.1795192 7     0 B (0 1 0 0 0) *
##              61) PC6< -0.1795192 13     0 D (0 0 0 1 0) *
##            31) PC17< 1.416631 645    15 E (0 0.0016 0.0031 0.019 0.98)  
##              62) PC3< -4.843272 18     8 D (0 0 0 0.56 0.44) *
##              63) PC3>=-4.843272 627     5 E (0 0.0016 0.0032 0.0032 0.99) *
```

```r
rpart.plot(model$finalModel)
```

```
## Warning: labs do not fit even at cex 0.15, there may be some overplotting
```

![](PeerReview_MachineLearnig_SergioRosales_files/figure-html/Algorithm-1.png)<!-- -->

```r
model
```

```
## CART 
## 
## 19622 samples
##    59 predictor
##     5 classes: 'A', 'B', 'C', 'D', 'E' 
## 
## Pre-processing: principal component signal extraction (81), centered
##  (81), scaled (81) 
## Resampling: Cross-Validated (10 fold, repeated 3 times) 
## Summary of sample sizes: 17660, 17660, 17661, 17659, 17660, 17660, ... 
## Resampling results across tuning parameters:
## 
##   cp          Accuracy   Kappa    
##   0.00000000  0.9119862  0.8886795
##   0.03004479  0.5088312  0.3774850
##   0.06008957  0.4046622  0.2193613
##   0.09013436  0.3840397  0.1916419
##   0.12017915  0.3714230  0.1668346
##   0.15022393  0.2843747  0.0000000
##   0.18026872  0.2843747  0.0000000
##   0.21031350  0.2843747  0.0000000
##   0.24035829  0.2843747  0.0000000
##   0.27040308  0.2843747  0.0000000
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was cp = 0.
```
### Out of sample error
The out of sample error is stimated to be 0,912:

```r
confusionMatrix(model)
```

```
## Cross-Validated (10 fold, repeated 3 times) Confusion Matrix 
## 
## (entries are percentual average cell counts across resamples)
##  
##           Reference
## Prediction    A    B    C    D    E
##          A 26.8  1.2  0.3  0.1  0.1
##          B  1.2 17.0  0.9  0.2  0.2
##          C  0.3  1.0 15.6  0.7  0.2
##          D  0.1  0.2  0.6 14.7  0.8
##          E  0.1  0.1  0.1  0.7 17.2
##                            
##  Accuracy (average) : 0.912
```

## Step 5: Prediction
Having the algorithm, finally I executed prediction on the testing subset of 20 cases:

```r
predict(model, newdata=testing)
```

```
##  [1] B A A A A E E C A A B B B A E E A B A B
## Levels: A B C D E
```
